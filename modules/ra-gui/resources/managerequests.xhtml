<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:component="http://java.sun.com/jsf/composite/component"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:t="http://myfaces.apache.org/tomahawk">
<ui:remove>
    <!--
    /*************************************************************************
     *                                                                       *
     *  EJBCA: The OpenSource Certificate Authority                          *
     *                                                                       *
     *  This software is free software; you can redistribute it and/or       *
     *  modify it under the terms of the GNU Lesser General Public           *
     *  License as published by the Free Software Foundation; either         *
     *  version 2.1 of the License, or any later version.                    *
     *                                                                       *
     *  See terms of license at gnu.org.                                     *
     *                                                                       *
     *************************************************************************/

     version: $Id$
     -->
</ui:remove>
<ui:composition template="/WEB-INF/include/template.xhtml">
    <ui:define name="content">
        <h:panelGroup layout="block" class="header" id="title">
            <h1><h:outputText value="#{msg.manage_requests_page_title}"/></h1>
        </h:panelGroup>
        <h:outputText value="#{msg.manage_requests_page_error_unauthorized}" rendered="#{!raAccessBean.authorizedToManageRequests}"/>
        <h:panelGroup layout="block" styleClass="content-body" rendered="#{raAccessBean.authorizedToManageRequests}">
            <h:form id="contentForm" class="pure-form" rendered="#{raAccessBean.authorizedToManageRequests}">
                
                <h:panelGroup layout="block">
                    <!-- or use links.  the active tab should appear as selected -->
                    <h:commandButton immediate="true" action="#{raManageRequestsBean.viewNeedsApproval}" disabled="#{raManageRequestsBean.viewingNeedsApproval}" value="#{msg.manage_requests_page_view_needs_approval}" />
                    <h:commandButton immediate="true" action="#{raManageRequestsBean.viewPendingApproval}" disabled="#{raManageRequestsBean.viewingPendingApproval}" value="#{msg.manage_requests_page_view_pending_approval}" />
                    <h:commandButton immediate="true" action="#{raManageRequestsBean.viewProcessed}" disabled="#{raManageRequestsBean.viewingProcessed}" value="#{msg.manage_requests_page_view_processed}" />
                    <h:commandButton immediate="true" action="#{raManageRequestsBean.viewCustom}" disabled="#{raManageRequestsBean.viewingCustom}" value="#{msg.manage_requests_page_view_custom}" />
                </h:panelGroup>
                
                <!-- todo might be useful to have searching/filtering -->
                <!-- todo should limit to things you have access to -->

                <h:panelGroup id="filteredResults" layout="block" style="margin-top: 10px;">
                    <h:outputText styleClass="fineprint" rendered="#{empty raManageRequestsBean.filteredResults}" value="#{msg.manage_requests_page_info_noresult}"/>
                    <h:outputText styleClass="fineprint" rendered="#{raManageRequestsBean.moreResultsAvailable}" value="#{msg.manage_requests_page_info_moreresults}"/>
                    <h:dataTable rendered="#{not empty raManageRequestsBean.filteredResults}" value="#{raManageRequestsBean.filteredResults}" var="raRequest"
                        styleClass="pure-table" rowClasses=",pure-table-odd">
                        <h:column>
                            <f:facet name="header">
                                <h:outputLabel for="sortRequestDate" value="#{msg.manage_requests_page_colhead_request_date} #{raManageRequestsBean.sortedByRequestDate}"/>
                                <h:commandButton id="sortRequestDate" action="#{raManageRequestsBean.sortByRequestDate}" value="#{msg.manage_requests_page_sort_command}" style="display: none;">
                                    <f:ajax execute="@this" render=":contentForm:filteredResults"
                                        onevent="function(data){onAjaxEvent(data,'contentForm:filteredResults');}"
                                        onerror="function(data){onAjaxError(data,'contentForm:filteredResults');}"/>
                                </h:commandButton>
                            </f:facet>
                            <h:outputText styleClass="fineprint" value="#{raRequest.requestDate}"/>
                        </h:column>
                    </h:dataTable>
                </h:panelGroup>
            </h:form>
        </h:panelGroup>
    </ui:define>
</ui:composition>
</html>
